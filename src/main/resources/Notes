SELECT CA.CLIENT_ACCOUNT_NUMBER, CCR.CURRENCY_CODE, CA.DISPLAY_BALANCE,
CCR.RATE, (CA.DISPLAY_BALANCE * CCR.RATE)
 FROM CLIENT_ACCOUNT CA JOIN CURRENCY_CONVERSION_RATE CCR
ON CA.CURRENCY_CODE = CCR.CURRENCY_CODE
WHERE CA.CLIENT_ID = 1


SELECT * FROM CLIENT_ACCOUNT CA
WHERE CA.CLIENT_ACCOUNT_NUMBER = 1073616681
AND CA.CLIENT_ID = 14


SELECT AT.TRANSACTIONAL  FROM CLIENT_ACCOUNT CA JOIN ACCOUNT_TYPE AT
ON AT.ACCOUNT_TYPE_CODE = CA.ACCOUNT_TYPE_CODE
WHERE CA.CLIENT_ACCOUNT_NUMBER = 1073616681

SELECT C.CLIENT_ID, C.SURNAME, CA.CLIENT_ACCOUNT_NUMBER,
AT.DESCRIPTION, CA.DISPLAY_BALANCE
FROM CLIENT C
JOIN CLIENT_ACCOUNT CA ON C.CLIENT_ID = CA.CLIENT_ID
JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_CODE = CA.ACCOUNT_TYPE_CODE
JOIN (
SELECT C.CLIENT_ID ID, MAX(CA.DISPLAY_BALANCE) MAX_BALANCE
FROM CLIENT C
JOIN CLIENT_ACCOUNT CA ON C.CLIENT_ID = CA.CLIENT_ID
JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_CODE = CA.ACCOUNT_TYPE_CODE
WHERE AT.TRANSACTIONAL  = TRUE
GROUP BY C.CLIENT_ID ) TABLE1
ON C.CLIENT_ID = TABLE1.ID
AND CA.DISPLAY_BALANCE = TABLE1.MAX_BALANCE
ORDER BY 1 DESC



SELECT CA.CLIENT_ID, SUM(CA.DISPLAY_BALANCE)  LOAN_BALANCE
FROM CLIENT_ACCOUNT CA
WHERE CA.ACCOUNT_TYPE_CODE IN ('PLOAN', 'HLOAN')
GROUP BY CA.CLIENT_ID

SELECT CA.CLIENT_ID, SUM(CA.DISPLAY_BALANCE) TRANSACTIONAL_BALANCE
FROM CLIENT_ACCOUNT CA JOIN ACCOUNT_TYPE AT
ON CA.ACCOUNT_TYPE_CODE = AT.ACCOUNT_TYPE_CODE
WHERE AT.TRANSACTIONAL = TRUE
GROUP BY CA.CLIENT_ID

SELECT CA.CLIENT_ID, SUM(CA.DISPLAY_BALANCE) NET_POSITION
FROM CLIENT_ACCOUNT CA JOIN ACCOUNT_TYPE AT
ON CA.ACCOUNT_TYPE_CODE = AT.ACCOUNT_TYPE_CODE
GROUP BY CA.CLIENT_ID


SELECT CONCAT(C.TITLE, ' ', C.NAME, ' ', C.SURNAME) CLIENT, TABLE1.LOAN_BALANCE,
TABLE2.TRANSACTIONAL_BALANCE, TABLE3.NET_POSITION  FROM CLIENT C
LEFT JOIN (
SELECT CA.CLIENT_ID CLIENT_ID1, SUM(CA.DISPLAY_BALANCE)  LOAN_BALANCE
FROM CLIENT_ACCOUNT CA
WHERE CA.ACCOUNT_TYPE_CODE IN ('PLOAN', 'HLOAN')
GROUP BY CA.CLIENT_ID
) TABLE1
ON C.CLIENT_ID = TABLE1.CLIENT_ID1
LEFT JOIN (
SELECT CA.CLIENT_ID CLIENT_ID2, SUM(CA.DISPLAY_BALANCE) TRANSACTIONAL_BALANCE
FROM CLIENT_ACCOUNT CA JOIN ACCOUNT_TYPE AT
ON CA.ACCOUNT_TYPE_CODE = AT.ACCOUNT_TYPE_CODE
WHERE AT.TRANSACTIONAL = TRUE
GROUP BY CA.CLIENT_ID
) TABLE2
ON C.CLIENT_ID = TABLE2.CLIENT_ID2
LEFT JOIN (
SELECT CA.CLIENT_ID CLIENT_ID3, SUM(CA.DISPLAY_BALANCE) NET_POSITION
FROM CLIENT_ACCOUNT CA JOIN ACCOUNT_TYPE AT
ON CA.ACCOUNT_TYPE_CODE = AT.ACCOUNT_TYPE_CODE
GROUP BY CA.CLIENT_ID
) TABLE3 ON C.CLIENT_ID = TABLE3.CLIENT_ID3